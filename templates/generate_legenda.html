{% extends "base.html" %}

{% block content %}
<div class="bg-white rounded-xl shadow p-6 space-y-6">
  <form id="form_generate_legendas" class="space-y-6">

    <!-- Grid principal com 4 colunas -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">

      <!-- üü© Colunas 1-2: Resumo das Narra√ß√µes + Pr√©-visualiza√ß√£o -->
      <div class="col-span-2 space-y-4">
        <!-- Lista de narra√ß√µes -->
        <div>
          <label for="legenda_list" class="block font-semibold mb-2 text-slate-700">Resumo das Narra√ß√µes</label>
          <select id="legenda_list" name="legenda_list" multiple size="10"
                  class="w-full border rounded p-2 shadow-sm">
            {% for cena in cenas %}
              <option value="{{ loop.index0 }}">
                Narra√ß√£o {{ loop.index }} ‚Äì {{ cena.narracao[:60] if cena.narracao else '[sem texto]' }}
              </option>
            {% endfor %}
          </select>
        </div>

        <!-- üü• Pr√©-visualiza√ß√£o -->
        <div>
          <h4 class="font-semibold text-slate-700 mb-2">üîç Pr√©-visualiza√ß√£o</h4>
            <div id="preview_legenda"
                 class="text-center rounded p-4 shadow-md"
                 style="background-color: #dbeafe; font-size: 24px; font-family: Arial;">
              Exemplo de Legenda
            </div>
        </div>
      </div>

      <!-- üü¶ Colunas 3-4: Configura√ß√µes -->
      <div class="md:col-start-3 col-span-2 bg-slate-50 border border-gray-200 rounded-lg p-4 shadow-sm space-y-4">
        <h3 class="font-semibold text-lg">‚öôÔ∏è Configura√ß√µes</h3>

        <!-- Escopo -->
        <div class="space-y-2">
          <label class="block"><input type="radio" name="scope" value="all" checked> Todas</label>
          <label class="flex items-center gap-2">
            <input type="radio" name="scope" value="single"> Somente a
            <input type="number" name="single_index" id="single_index" min="1" placeholder="n¬∫"
                   class="w-20 border rounded p-1" disabled>
          </label>
          <label class="flex items-center gap-2">
            <input type="radio" name="scope" value="from"> A partir da
            <input type="number" name="from_index" id="from_index" min="1" placeholder="n¬∫"
                   class="w-20 border rounded p-1" disabled>
          </label>
        </div>

        <!-- Modo de legenda -->
        <div>
          <label for="modo_legenda" class="block font-semibold text-slate-700">Modo de Legenda</label>
          <select id="modo_legenda" name="modo" class="w-full border rounded p-2">
            <option value="palavra">Por Palavra</option>
            <option value="linha1">1 Linha</option>
            <option value="linha2" selected>2 Linhas</option>
            <option value="linha3">3 Linhas</option>
          </select>
        </div>

        <!-- Fonte -->
        <div>
          <label for="fonte" class="block font-semibold text-slate-700">Fonte</label>
          <select id="fonte" name="fonte" class="w-full border rounded p-2">
            <option value="Arial" style="font-family: Arial;" selected>Arial</option>
            <option value="Roboto" style="font-family: Roboto;">Roboto</option>
            <option value="Open Sans" style="font-family: 'Open Sans';">Open Sans</option>
            <option value="Montserrat" style="font-family: Montserrat;">Montserrat</option>
            <option value="Lato" style="font-family: Lato;">Lato</option>
            <option value="Bebas Neue" style="font-family: 'Bebas Neue';">Bebas Neue</option>
            <option value="Courier New" style="font-family: 'Courier New';">Courier New</option>
            <option value="Georgia" style="font-family: Georgia;">Georgia</option>
          </select>
        </div>

        <!-- Tamanho da Fonte -->
        <div>
          <label for="tamanho" class="block font-semibold text-slate-700">Tamanho da Fonte</label>
          <input type="number" id="tamanho" name="tamanho" value="24" min="10" max="72"
                 class="w-full border rounded p-2">
        </div>

        <!-- Cor da legenda -->
        <div>
          <label for="cor" class="block font-semibold text-slate-700">Cor do Texto</label>
          <input type="color" id="cor" name="cor" value="#000000" class="w-full h-10 border rounded p-1">
        </div>

        <!-- Estilo Visual -->
        <div>
          <label for="estilo" class="block font-semibold text-slate-700">Estilo Visual</label>
          <select id="estilo" name="estilo" class="w-full border rounded p-2">
            <option value="simples">Cor Simples</option>
            <option value="borda">Com Borda</option>
            <option value="sombra">Esfuma√ßada (Sombra)</option>
            <option value="glow">Brilho (Glow)</option>
            <option value="tv">Estilo TV</option>
            <option value="retro">Retr√¥</option>
            <option value="cartoon">Cartoon</option>
            <option value="inverso">Inverso</option>
            <option value="fundo">Fundo Transl√∫cido</option>
          </select>
        </div>

        <!-- Anima√ß√£o -->
        <div>
          <label for="animacao" class="block font-semibold text-slate-700">Anima√ß√£o</label>
          <select id="animacao" name="animacao" class="w-full border rounded p-2">
            <option value="nenhuma">Nenhuma</option>
            <option value="fade">Fade-in</option>
            <option value="karaoke">Karaok√™</option>
            <option value="zoom">Zoom</option>
            <option value="deslizar">Deslizar</option>
            <option value="piscar">Piscar</option>
            <option value="pulsar">Pulsar</option>
          </select>
        </div>

        <!-- Bot√£o de a√ß√£o -->
        <button id="generate_legendas" type="button"
                class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded shadow">
          üìù Gerar Legendas
        </button>
      </div>
    </div>

    <!-- Barra de Progresso -->
    <div class="w-full bg-gray-200 rounded-full h-4 mt-4">
      <div id="progress_fill" class="bg-blue-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
    </div>

    <!-- Log -->
    <div class="bg-black text-green-400 text-sm p-4 rounded-md h-40 overflow-y-auto text-left font-mono whitespace-pre">
      <pre id="log"></pre>
    </div>

  </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/generate_legenda.js') }}"></script>
{% endblock %}
